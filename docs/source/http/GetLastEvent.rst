GetLastEvent
============

Метод ``GetLastEvent`` предназначен для получения последнего события в ящике.

.. http:get:: /GetLastEvent

    :queryparam boxId: идентификатор ящика организации.

    :requestheader Authorization: данные, необходимые для :doc:`авторизации <../Authorization>`.

    :statuscode 200: операция успешно завершена.
    :statuscode 204: в ящике нет событий.
    :statuscode 400: данные в запросе имеют неверный формат или отсутствуют обязательные параметры.
    :statuscode 401: в запросе отсутствует HTTP-заголовок ``Authorization`` или в этом заголовке содержатся некорректные авторизационные данные.
    :statuscode 402: у организации с указанным идентификатором ``boxId`` закончилась подписка на API.
    :statuscode 403: доступ к ящику с предоставленным авторизационным токеном запрещен.
    :statuscode 405: используется неподходящий HTTP-метод.
    :statuscode 500: при обработке запроса возникла непредвиденная ошибка.

    :response Body: Тело ответа содержит результат выполнения операции, представленный структурой :doc:`../proto/BoxEvent`.

Лента событий формируется по подразделению организации, в котором состоит пользователь. Подразделение организации, в котором состоит пользователь, можно найти в структуре :doc:`../proto/OrganizationUserPermissions`, в поле ``UserDepartmentId``.

Все события по черновикам доступны пользователям, у которых есть доступ ко всем документам организации. Доступ пользователя можно увидеть в структуре :doc:`../proto/DocumentAccessLevel`.

Если у пользователя есть доступ ко всем документам организации, в ленту попадут события по всему ящику.

.. important::
    К подразделению организации привязываются все события, произошедшие с 15.03.2017. События, произошедшие до 15.03.2017, может получить только пользователь, который имеет доступ ко всем документам организации.

Содержимое документов, ассоциированных с событиями из списка, в структуру данных не сохраняется, то есть возвращается только метаинформация об изменениях в ящике. Такой подход гарантирует, что ответ на запрос имеет предсказуемый и небольшой размер.